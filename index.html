function submitToSheet() {
  const formData = new URLSearchParams();
  formData.append("name", document.getElementById('name').value.trim());
  formData.append("personType", document.getElementById('person').value);
  formData.append("relation", document.getElementById('relation').value);
  formData.append("detailType", document.getElementById('detail').value);

  fetch("https://script.google.com/macros/s/AKfycbwTACWiL-zV7x8nW8qXUNMUofMc4k6tpwEoV3-R1m5Qufp15ZIYxkecxZkIprtbFPGQDg/exec", {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(response => {
    document.getElementById('message').textContent = "ลงทะเบียนสำเร็จ ขอบคุณค่ะ/ครับ!";
    console.log("Response:", response);
  })
  .catch(err => {
    console.error(err);
    document.getElementById('message').textContent = "ไม่สามารถเชื่อมต่อได้";
  });
}
